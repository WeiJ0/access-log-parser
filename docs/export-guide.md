# Excel 匯出功能使用指南

## 功能簡介

Apache Access Log Analyzer 提供強大的 Excel 匯出功能，可將日誌分析結果匯出為結構化的 .xlsx 檔案，包含三個工作表：

1. **日誌條目** - 完整的日誌記錄
2. **統計資訊** - Top 10 IP、路徑、狀態碼分布等
3. **爬蟲檢測** - 智能識別的爬蟲訪問

## 如何使用

### 步驟 1: 載入日誌檔案
1. 啟動 Apache Access Log Analyzer
2. 點擊「開啟檔案」按鈕
3. 選擇您的 Apache access log 檔案
4. 等待解析完成

### 步驟 2: 匯出至 Excel
1. 確認日誌已成功載入（可在儀表板查看統計資訊）
2. 點擊工具列的「匯出至 Excel」按鈕（📥 圖示）
3. 在檔案對話框中選擇儲存位置
4. 輸入檔案名稱（預設為 `[原始檔名].xlsx`）
5. 點擊「儲存」

### 步驟 3: 等待匯出完成
- 進度對話框會顯示即時進度
- 顯示當前處理狀態
- 如有警告訊息會即時顯示（如資料截斷）

### 步驟 4: 查看結果
- 匯出完成後會顯示成功通知
- 通知包含檔案路徑和大小
- 點擊通知可關閉
- 通知會在 6 秒後自動消失

## Excel 檔案結構

### 工作表 1: 日誌條目

包含所有解析的日誌記錄，欄位如下：

| 欄位 | 說明 | 範例 |
|------|------|------|
| 行號 | 原始檔案行號 | 1, 2, 3... |
| 時間 | 請求時間 | 2025-11-07 14:30:15 |
| IP 地址 | 客戶端 IP | 192.168.1.100 |
| 方法 | HTTP 方法 | GET, POST |
| 路徑 | 請求路徑 | /api/users |
| 狀態碼 | HTTP 狀態 | 200, 404, 500 |
| 回應大小 | 位元組數 | 1024 |
| Referer | 來源頁面 | https://example.com |
| User-Agent | 瀏覽器/爬蟲 | Mozilla/5.0... |

### 工作表 2: 統計資訊

包含以下統計區塊：

#### 總體統計
- 總請求數
- 成功請求數
- 錯誤請求數
- 唯一 IP 數量
- 唯一路徑數量
- 爬蟲請求數
- 總流量（MB）
- 平均回應大小

#### Top 10 IP 地址
- IP 地址
- 請求數
- 百分比

#### Top 10 請求路徑
- 請求路徑
- 請求數
- 百分比

#### HTTP 狀態碼分布
- 狀態碼範圍（2xx, 3xx, 4xx, 5xx）
- 數量
- 百分比

#### HTTP 方法統計
- 方法（GET, POST, PUT 等）
- 數量
- 百分比

#### 流量統計
- 總接收流量
- 總發送流量
- 平均請求大小
- 平均回應大小

#### 時段分析
- 小時 (0-23)
- 請求數
- 百分比

### 工作表 3: 爬蟲檢測

智能識別的爬蟲訪問記錄：

| 欄位 | 說明 | 範例 |
|------|------|------|
| IP 地址 | 爬蟲 IP | 66.249.66.1 |
| User-Agent | 爬蟲標識 | Googlebot/2.1 |
| 爬蟲類型 | 分類 | search_engine |
| 信心度 | 檢測信心 | 95.0% |
| 請求數 | 訪問次數 | 1523 |

支援的爬蟲類型：
- `search_engine` - 搜尋引擎（Google, Bing 等）
- `social_media` - 社交媒體（Facebook, Twitter 等）
- `development` - 開發工具（curl, wget 等）
- `seo_tool` - SEO 工具（Semrush, Ahrefs 等）
- `content_aggregator` - 內容聚合器
- `bot` - 其他爬蟲

## 效能參考

| 日誌大小 | 記錄數 | 預計耗時 |
|----------|--------|----------|
| 小型 | < 10,000 | < 1 秒 |
| 中型 | 10,000 - 100,000 | 1-5 秒 |
| 大型 | 100,000 - 1,000,000 | 5-30 秒 |
| 超大型 | > 1,000,000 | > 30 秒 |

**注意**: 實際耗時取決於電腦效能和記錄複雜度。

## 常見問題

### Q: 為什麼匯出按鈕是灰色的？
**A**: 可能的原因：
1. 尚未開啟任何日誌檔案
2. 檔案正在載入中
3. 正在執行其他匯出作業

### Q: 匯出過程中可以做其他事嗎？
**A**: 為確保資料完整性，匯出期間會鎖定操作。建議等待匯出完成。

### Q: Excel 檔案打不開怎麼辦？
**A**: 請確認：
1. 使用 Excel 2007 或更新版本
2. 或使用 Google Sheets
3. 或使用 LibreOffice Calc
4. 檔案未損壞（重新匯出試試）

### Q: 為什麼資料被截斷了？
**A**: Excel 有 1,048,576 行的限制。如果日誌記錄超過此限制，多餘的資料會被截斷，並在匯出時顯示警告。

**解決方案**:
- 使用時間範圍篩選（未來版本）
- 分割大型日誌檔案
- 使用 CSV 格式（未來版本）

### Q: 可以同時匯出多個檔案嗎？
**A**: 目前版本需要逐一匯出。批次匯出功能計劃在未來版本中加入。

### Q: 匯出的檔案可以編輯嗎？
**A**: 可以！這是標準的 Excel 檔案，您可以：
- 添加圖表
- 應用篩選
- 新增公式
- 合併儲存格
- 任何 Excel 支援的操作

### Q: 可以自訂匯出的欄位嗎？
**A**: 目前版本匯出所有欄位。欄位自訂功能計劃在未來版本中加入。

### Q: 匯出失敗了怎麼辦？
**A**: 檢查以下項目：
1. 是否有足夠的磁碟空間
2. 是否有檔案寫入權限
3. 檔案名稱是否合法
4. 重試匯出
5. 查看錯誤訊息並根據提示操作

## 技術規格

### 支援的 Excel 版本
- Microsoft Excel 2007 或更新版本
- Google Sheets
- LibreOffice Calc 6.0 或更新版本
- WPS Office

### 檔案格式
- 格式: XLSX (Office Open XML)
- 壓縮: 預設 ZIP 壓縮
- 編碼: UTF-8

### 限制
- 最大行數: 1,048,576 行/工作表
- 最大欄數: 16,384 欄/工作表
- 建議檔案大小: < 50 MB

### 匯出內容大小估算
```
匯出檔案大小 ≈ 原始日誌大小 × (50-80%)
```

範例：
- 10 MB 日誌 → 約 5-8 MB Excel 檔案
- 100 MB 日誌 → 約 50-80 MB Excel 檔案

## 進階使用

### 大型檔案最佳實踐

1. **記憶體考量**
   - 建議至少有檔案大小 2 倍的可用 RAM
   - 關閉其他佔用記憶體的應用程式

2. **匯出策略**
   - 先測試小範圍資料
   - 確認格式符合需求
   - 再匯出完整資料

3. **效能優化**
   - 使用 SSD 硬碟可顯著提升速度
   - 確保充足的磁碟空間（至少 2 倍檔案大小）

### Excel 後處理建議

1. **建立樞紐分析表**
   ```
   資料 → 樞紐分析表 → 選擇工作表
   ```

2. **添加圖表**
   ```
   插入 → 圖表 → 選擇類型
   ```

3. **應用條件格式**
   ```
   常用 → 條件格式 → 選擇規則
   ```

4. **建立儀表板**
   - 使用多個圖表
   - 添加切片器
   - 設定資料更新

## 疑難排解

### 匯出很慢
**可能原因**:
- 記錄數量太多
- 磁碟效能差
- 記憶體不足

**解決方案**:
- 關閉其他應用程式
- 確保使用 SSD
- 增加系統記憶體

### 匯出後檔案損壞
**可能原因**:
- 磁碟空間不足
- 防毒軟體干擾
- 寫入中斷

**解決方案**:
- 檢查磁碟空間
- 暫時關閉防毒軟體
- 重新匯出

### 中文顯示亂碼
**可能原因**:
- Excel 版本太舊
- 編碼設定錯誤

**解決方案**:
- 更新 Excel 版本
- 使用 Google Sheets
- 匯入時選擇 UTF-8 編碼

## 回饋與建議

如果您有任何問題或建議，請：
1. 查看完整文檔
2. 搜尋常見問題
3. 聯繫技術支援
4. 提交功能請求

---

**版本**: 1.0.0  
**最後更新**: 2025-11-07  
**作者**: Apache Log Analyzer Team

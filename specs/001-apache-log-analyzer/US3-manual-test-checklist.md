# User Story 3 手動測試檢查清單

## 測試前準備

- [ ] 確認應用程式已編譯完成 (`go build` 和 `npm run build` 都成功)
- [ ] 準備測試用的 Apache access log 檔案 (建議使用真實日誌檔案)

## 功能測試

### 1. 匯出按鈕可見性測試
- [ ] 啟動應用程式
- [ ] 驗證工具列有「匯出至 Excel」按鈕
- [ ] 驗證按鈕在未開啟檔案時為禁用狀態
- [ ] 開啟一個日誌檔案
- [ ] 驗證按鈕變為啟用狀態

### 2. 儲存位置選擇測試
- [ ] 點擊「匯出至 Excel」按鈕
- [ ] 驗證系統開啟原生儲存對話框
- [ ] 驗證預設檔案名稱為 `[原始檔名].xlsx`
- [ ] 選擇儲存位置並點擊「儲存」
- [ ] 驗證進度對話框出現

### 3. 匯出進度顯示測試
- [ ] 驗證進度對話框標題為「正在匯出至 Excel」
- [ ] 驗證有進度條顯示
- [ ] 驗證有百分比顯示
- [ ] 驗證有狀態訊息顯示（如「準備匯出...」）

### 4. 匯出成功測試
- [ ] 等待匯出完成
- [ ] 驗證進度達到 100%
- [ ] 驗證顯示「匯出完成！」訊息
- [ ] 驗證出現成功通知（綠色 Snackbar）
- [ ] 驗證通知顯示檔案路徑和大小
- [ ] 關閉通知後驗證可正常關閉

### 5. Excel 檔案結構測試
- [ ] 使用 Excel 或 Google Sheets 開啟匯出的檔案
- [ ] 驗證有 3 個工作表：
  - [ ] 「日誌條目」工作表
  - [ ] 「統計資訊」工作表
  - [ ] 「爬蟲檢測」工作表

### 6. 日誌條目工作表測試
- [ ] 驗證有標題行（粗體、有背景色）
- [ ] 驗證欄位包含：行號、時間、IP、方法、路徑、狀態碼、回應大小、Referer、User-Agent
- [ ] 驗證時間格式正確 (YYYY-MM-DD HH:MM:SS)
- [ ] 驗證狀態碼為數字
- [ ] 驗證資料與原始日誌一致

### 7. 統計資訊工作表測試
- [ ] 驗證有以下統計區塊：
  - [ ] 總體統計（總請求數、唯一 IP、唯一路徑等）
  - [ ] Top 10 IP 地址
  - [ ] Top 10 請求路徑
  - [ ] HTTP 狀態碼分布
  - [ ] HTTP 方法統計
  - [ ] 流量統計
  - [ ] 時段分析
- [ ] 驗證數據格式正確
- [ ] 驗證百分比計算正確

### 8. 爬蟲檢測工作表測試
- [ ] 驗證有標題行
- [ ] 驗證欄位包含：IP 地址、User-Agent、爬蟲類型、信心度、請求數
- [ ] 驗證信心度為百分比格式
- [ ] 驗證爬蟲類型正確（如 search_engine, social_media 等）

### 9. 大檔案測試
- [ ] 使用大於 100,000 筆記錄的日誌檔案
- [ ] 驗證匯出時間合理（≤30 秒/百萬筆）
- [ ] 驗證記憶體使用穩定（不會持續增長）
- [ ] 驗證匯出完成後無記憶體洩漏

### 10. Excel 行數限制測試
- [ ] 使用超過 1,048,576 筆記錄的日誌（如果有）
- [ ] 驗證出現警告訊息
- [ ] 驗證警告說明資料被截斷
- [ ] 驗證匯出的檔案仍可正常開啟

### 11. 錯誤處理測試

#### 11.1 取消儲存
- [ ] 點擊匯出按鈕
- [ ] 在儲存對話框點擊「取消」
- [ ] 驗證無錯誤訊息
- [ ] 驗證可繼續正常操作

#### 11.2 磁碟空間不足（模擬）
- [ ] 選擇一個空間不足的磁碟（如果可能）
- [ ] 驗證顯示清楚的錯誤訊息
- [ ] 驗證不會崩潰

#### 11.3 無寫入權限（模擬）
- [ ] 選擇一個無寫入權限的位置（如 C:\Windows\System32）
- [ ] 驗證顯示權限錯誤訊息
- [ ] 驗證不會崩潰

#### 11.4 檔案已存在
- [ ] 匯出到已存在的檔案
- [ ] 驗證系統提示是否覆蓋
- [ ] 選擇覆蓋並驗證成功

### 12. 中文本地化測試
- [ ] 驗證所有按鈕文字為繁體中文
- [ ] 驗證所有對話框標題為繁體中文
- [ ] 驗證所有狀態訊息為繁體中文
- [ ] 驗證所有錯誤訊息為繁體中文
- [ ] 驗證 Excel 檔案中的標題為繁體中文

### 13. 使用者體驗測試
- [ ] 驗證匯出過程中無法關閉應用程式（防止資料損壞）
- [ ] 驗證匯出過程中其他按鈕為禁用狀態
- [ ] 驗證進度更新流暢（無卡頓）
- [ ] 驗證成功通知自動消失（6 秒後）

## 效能基準測試

| 記錄數 | 預期耗時 | 實際耗時 | 通過 |
|--------|----------|----------|------|
| 1,000 | < 1 秒 | _______ | ☐ |
| 10,000 | < 2 秒 | _______ | ☐ |
| 100,000 | < 5 秒 | _______ | ☐ |
| 1,000,000 | ≤ 30 秒 | _______ | ☐ |

## 跨平台測試（如適用）

### Windows
- [ ] 驗證儲存對話框正確顯示
- [ ] 驗證檔案路徑格式正確 (反斜線)
- [ ] 驗證 Excel 檔案可被開啟

### macOS
- [ ] 驗證儲存對話框正確顯示
- [ ] 驗證檔案路徑格式正確 (斜線)
- [ ] 驗證 Excel 檔案可被開啟

### Linux
- [ ] 驗證儲存對話框正確顯示
- [ ] 驗證檔案路徑格式正確 (斜線)
- [ ] 驗證 Excel 檔案可被 LibreOffice 開啟

## 整合測試

- [ ] 驗證可連續匯出多次（不需重啟應用程式）
- [ ] 驗證可匯出不同檔案（切換分頁後匯出）
- [ ] 驗證匯出不影響正常的日誌瀏覽功能
- [ ] 驗證匯出後可繼續開啟新檔案

## 回歸測試

- [ ] 驗證 User Story 1（載入和顯示）功能正常
- [ ] 驗證 User Story 2（統計分析）功能正常
- [ ] 驗證錯誤處理仍正常運作
- [ ] 驗證多檔案分頁功能正常

## 測試結果總結

**測試日期**: __________  
**測試人員**: __________  
**應用程式版本**: __________  

**通過測試數量**: _____ / _____  
**失敗測試數量**: _____  
**阻塞問題**: _____  

**整體評估**:
- [ ] 可發布
- [ ] 需要修復後再測試
- [ ] 需要重大修改

**備註**:
___________________________________________________
___________________________________________________
___________________________________________________
